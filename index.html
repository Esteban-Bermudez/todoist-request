<!DOCTYPE html>
<html>
<head>
	<title>Todoist Request Forwader</title>
	<link rel="stylesheet" href="style.css">
	
</head>
<body onload="sendRequest()" style="text-align: center;">
		<h1>HTTP Todoist Request Forwader</h1>
		<p id="response">Waiting for response...</p>
	<script>
		function sendRequest() {
      
			// Set up request parameters
      const searchParams = new URLSearchParams(window.location.search);
      const apitoken = searchParams.get('apitoken');
      //const action = searchParams.get('action')

			const url = "https://api.todoist.com/rest/v2/tasks/6183729031/close";
      
			const options = {
				method: "POST",
				headers: {
					"Content-Type": "application/json",
          "Authorization":`Bearer ${apitoken}`
				},
				body: JSON.stringify()
			};

			// Send request and handle response
			fetch(url, options)
				.then(response => {
          if (response.status === 204) {
						// If response status is 204, there is no content to parse
						return "Response 204";
					} else {
						// Otherwise, parse the response as JSON
						return response.json();
					}
        })
				.then(data => {
          console.log(data);
					document.getElementById("response").innerText = JSON.stringify(data);
				})
				.catch(error => {
					console.error("Error:", error);
				});
		}
	</script>
</body>
</html>
